import{r as Kt,a as o,q as Ue,t as Gt,O as Vt,w as Wt}from"./chunk-OIYGIGL5-BjQr_l_M.js";import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{s as k}from"./supabase-BHBWl_Zr.js";import{u as ne,a as Yt,S as oe,c as Xt}from"./index-yifceNX_.js";import{c as j}from"./utils-BEHD0UYf.js";import{B as E}from"./button-Lf--0ePE.js";import{R as Jt,C as Zt,a as He,T as er,D as tr,P as rr,O as ar}from"./index-B5FmTQpp.js";import{X as Ke}from"./x-GpSf1MKW.js";import{c as ie,u as sr,a as H,b as Ge,d as Ve,e as R,f as We,R as nr,A as or,P as ir,g as lr,D as cr,C as dr}from"./index-BsqcEdqH.js";import{P as le}from"./index-7INpPUcb.js";import{P as T}from"./index-B2a0W2do.js";import{R as ur}from"./index-BnHrxEV7.js";import{c as Q}from"./createLucideIcon-CwMMISn7.js";import{u as ce}from"./auth-provider-Diczkjh1.js";import{S as fr,n as L,k as pr,l as Ye,u as z,a as mr}from"./QueryClientProvider-ChAT3DNt.js";import{Q as Xe,a as hr,b as xr,e as gr,c as br,d as vr,s as Re,f as Te,w as yr,g as wr}from"./useBaseQuery-CE2J4sU2.js";import{u as J}from"./useMutation-CbNZKspy.js";import{T as jr}from"./index-BRsIKSDg.js";import{F as Cr}from"./file-text-BVIg4UvA.js";import{S as Nr}from"./settings-DWiAJPd0.js";import{S as Sr,C as _r}from"./shield-check-C1YTS7NA.js";import{U as Er}from"./utensils-crossed-DKyfe-yl.js";import{Q as Rr,C as Tr,D as Or}from"./index-BCAIc7o-.js";import{D as de,a as ue,b as fe,c as pe,d as me,e as Je}from"./dialog-CZqiNxs2.js";import{Q as Ze}from"./qr-code-DupRlWHo.js";import{I as kr}from"./input-B6_poRDs.js";import{u as Dr}from"./AdminService-CgJGPFg0.js";import{M as Ar}from"./mode-toggle-D08M6dEu.js";import{D as et,a as tt,b as rt,c as at,d as Mr,e as re}from"./dropdown-menu-BJZCd5Pg.js";import"./index-CpAFY4EY.js";import"./mutation-BtzxBK-B.js";import"./useQuery-DJjewD8N.js";import"./theme-provider-CUZGnFwL.js";import"./sun-DiAVwtG2.js";import"./check-P3aSJU2R.js";var Z={exports:{}},ee={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oe;function Ir(){if(Oe)return ee;Oe=1;var e=Kt();function r(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var a=typeof Object.is=="function"?Object.is:r,s=e.useState,n=e.useEffect,i=e.useLayoutEffect,l=e.useDebugValue;function d(f,m){var g=m(),x=s({inst:{value:g,getSnapshot:m}}),h=x[0].inst,y=x[1];return i(function(){h.value=g,h.getSnapshot=m,c(h)&&y({inst:h})},[f,g,m]),n(function(){return c(h)&&y({inst:h}),f(function(){c(h)&&y({inst:h})})},[f]),l(g),g}function c(f){var m=f.getSnapshot;f=f.value;try{var g=m();return!a(f,g)}catch{return!0}}function p(f,m){return m()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:d;return ee.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,ee}var ke;function Pr(){return ke||(ke=1,Z.exports=Ir()),Z.exports}var Lr=Pr();function qr(){return Lr.useSyncExternalStore(Qr,()=>!0,()=>!1)}function Qr(){return()=>{}}var he="Avatar",[zr]=ie(he),[$r,st]=zr(he),nt=o.forwardRef((e,r)=>{const{__scopeAvatar:a,...s}=e,[n,i]=o.useState("idle");return t.jsx($r,{scope:a,imageLoadingStatus:n,onImageLoadingStatusChange:i,children:t.jsx(T.span,{...s,ref:r})})});nt.displayName=he;var ot="AvatarImage",it=o.forwardRef((e,r)=>{const{__scopeAvatar:a,src:s,onLoadingStatusChange:n=()=>{},...i}=e,l=st(ot,a),d=Fr(s,i),c=sr(p=>{n(p),l.onImageLoadingStatusChange(p)});return H(()=>{d!=="idle"&&c(d)},[d,c]),d==="loaded"?t.jsx(T.img,{...i,ref:r,src:s}):null});it.displayName=ot;var lt="AvatarFallback",ct=o.forwardRef((e,r)=>{const{__scopeAvatar:a,delayMs:s,...n}=e,i=st(lt,a),[l,d]=o.useState(s===void 0);return o.useEffect(()=>{if(s!==void 0){const c=window.setTimeout(()=>d(!0),s);return()=>window.clearTimeout(c)}},[s]),l&&i.imageLoadingStatus!=="loaded"?t.jsx(T.span,{...n,ref:r}):null});ct.displayName=lt;function De(e,r){return e?r?(e.src!==r&&(e.src=r),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Fr(e,{referrerPolicy:r,crossOrigin:a}){const s=qr(),n=o.useRef(null),i=s?(n.current||(n.current=new window.Image),n.current):null,[l,d]=o.useState(()=>De(i,e));return H(()=>{d(De(i,e))},[i,e]),H(()=>{const c=f=>()=>{d(f)};if(!i)return;const p=c("loaded"),u=c("error");return i.addEventListener("load",p),i.addEventListener("error",u),r&&(i.referrerPolicy=r),typeof a=="string"&&(i.crossOrigin=a),()=>{i.removeEventListener("load",p),i.removeEventListener("error",u)}},[i,a,r]),l}var Br=nt,Ur=it,Hr=ct;function Ae({className:e,...r}){return t.jsx(Br,{"data-slot":"avatar",className:j("relative flex size-8 shrink-0 overflow-hidden rounded-full",e),...r})}function Me({className:e,...r}){return t.jsx(Ur,{"data-slot":"avatar-image",className:j("aspect-square size-full",e),...r})}function Ie({className:e,...r}){return t.jsx(Hr,{"data-slot":"avatar-fallback",className:j("bg-muted flex size-full items-center justify-center rounded-full",e),...r})}/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],Gr=Q("chevrons-up-down",Kr);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Wr=Q("ellipsis-vertical",Vr);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Xr=Q("log-out",Yr);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],Zr=Q("panel-left",Jr);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ta=Q("user",ea);var K="Collapsible",[ra]=ie(K),[aa,xe]=ra(K),dt=o.forwardRef((e,r)=>{const{__scopeCollapsible:a,open:s,defaultOpen:n,disabled:i,onOpenChange:l,...d}=e,[c,p]=Ge({prop:s,defaultProp:n??!1,onChange:l,caller:K});return t.jsx(aa,{scope:a,disabled:i,contentId:Ve(),open:c,onOpenToggle:o.useCallback(()=>p(u=>!u),[p]),children:t.jsx(T.div,{"data-state":be(c),"data-disabled":i?"":void 0,...d,ref:r})})});dt.displayName=K;var ut="CollapsibleTrigger",ft=o.forwardRef((e,r)=>{const{__scopeCollapsible:a,...s}=e,n=xe(ut,a);return t.jsx(T.button,{type:"button","aria-controls":n.contentId,"aria-expanded":n.open||!1,"data-state":be(n.open),"data-disabled":n.disabled?"":void 0,disabled:n.disabled,...s,ref:r,onClick:R(e.onClick,n.onOpenToggle)})});ft.displayName=ut;var ge="CollapsibleContent",pt=o.forwardRef((e,r)=>{const{forceMount:a,...s}=e,n=xe(ge,e.__scopeCollapsible);return t.jsx(le,{present:a||n.open,children:({present:i})=>t.jsx(sa,{...s,ref:r,present:i})})});pt.displayName=ge;var sa=o.forwardRef((e,r)=>{const{__scopeCollapsible:a,present:s,children:n,...i}=e,l=xe(ge,a),[d,c]=o.useState(s),p=o.useRef(null),u=ne(r,p),f=o.useRef(0),m=f.current,g=o.useRef(0),x=g.current,h=l.open||d,y=o.useRef(h),b=o.useRef(void 0);return o.useEffect(()=>{const v=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(v)},[]),H(()=>{const v=p.current;if(v){b.current=b.current||{transitionDuration:v.style.transitionDuration,animationName:v.style.animationName},v.style.transitionDuration="0s",v.style.animationName="none";const C=v.getBoundingClientRect();f.current=C.height,g.current=C.width,y.current||(v.style.transitionDuration=b.current.transitionDuration,v.style.animationName=b.current.animationName),c(s)}},[l.open,s]),t.jsx(T.div,{"data-state":be(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!h,...i,ref:u,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":x?`${x}px`:void 0,...e.style},children:h&&n})});function be(e){return e?"open":"closed"}var na=dt;function oa({...e}){return t.jsx(na,{"data-slot":"collapsible",...e})}function ia({...e}){return t.jsx(ft,{"data-slot":"collapsible-trigger",...e})}function la({...e}){return t.jsx(pt,{"data-slot":"collapsible-content",...e})}const te=768;function ca(){const[e,r]=o.useState(void 0);return o.useEffect(()=>{const a=window.matchMedia(`(max-width: ${te-1}px)`),s=()=>{r(window.innerWidth<te)};return a.addEventListener("change",s),r(window.innerWidth<te),()=>a.removeEventListener("change",s)},[]),!!e}function da({...e}){return t.jsx(Jt,{"data-slot":"sheet",...e})}function ua({...e}){return t.jsx(rr,{"data-slot":"sheet-portal",...e})}function fa({className:e,...r}){return t.jsx(ar,{"data-slot":"sheet-overlay",className:j("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...r})}function pa({className:e,children:r,side:a="right",...s}){return t.jsxs(ua,{children:[t.jsx(fa,{}),t.jsxs(Zt,{"data-slot":"sheet-content",className:j("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",a==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",a==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",a==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",a==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",e),...s,children:[r,t.jsxs(He,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[t.jsx(Ke,{className:"size-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function ma({className:e,...r}){return t.jsx("div",{"data-slot":"sheet-header",className:j("flex flex-col gap-1.5 p-4",e),...r})}function ha({className:e,...r}){return t.jsx(er,{"data-slot":"sheet-title",className:j("text-foreground font-semibold",e),...r})}function xa({className:e,...r}){return t.jsx(tr,{"data-slot":"sheet-description",className:j("text-muted-foreground text-sm",e),...r})}var[G]=ie("Tooltip",[We]),V=We(),mt="TooltipProvider",ga=700,ae="tooltip.open",[ba,ve]=G(mt),ht=e=>{const{__scopeTooltip:r,delayDuration:a=ga,skipDelayDuration:s=300,disableHoverableContent:n=!1,children:i}=e,l=o.useRef(!0),d=o.useRef(!1),c=o.useRef(0);return o.useEffect(()=>{const p=c.current;return()=>window.clearTimeout(p)},[]),t.jsx(ba,{scope:r,isOpenDelayedRef:l,delayDuration:a,onOpen:o.useCallback(()=>{window.clearTimeout(c.current),l.current=!1},[]),onClose:o.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>l.current=!0,s)},[s]),isPointerInTransitRef:d,onPointerInTransitChange:o.useCallback(p=>{d.current=p},[]),disableHoverableContent:n,children:i})};ht.displayName=mt;var q="Tooltip",[va,$]=G(q),xt=e=>{const{__scopeTooltip:r,children:a,open:s,defaultOpen:n,onOpenChange:i,disableHoverableContent:l,delayDuration:d}=e,c=ve(q,e.__scopeTooltip),p=V(r),[u,f]=o.useState(null),m=Ve(),g=o.useRef(0),x=l??c.disableHoverableContent,h=d??c.delayDuration,y=o.useRef(!1),[b,v]=Ge({prop:s,defaultProp:n??!1,onChange:F=>{F?(c.onOpen(),document.dispatchEvent(new CustomEvent(ae))):c.onClose(),i?.(F)},caller:q}),C=o.useMemo(()=>b?y.current?"delayed-open":"instant-open":"closed",[b]),S=o.useCallback(()=>{window.clearTimeout(g.current),g.current=0,y.current=!1,v(!0)},[v]),_=o.useCallback(()=>{window.clearTimeout(g.current),g.current=0,v(!1)},[v]),O=o.useCallback(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>{y.current=!0,v(!0),g.current=0},h)},[h,v]);return o.useEffect(()=>()=>{g.current&&(window.clearTimeout(g.current),g.current=0)},[]),t.jsx(nr,{...p,children:t.jsx(va,{scope:r,contentId:m,open:b,stateAttribute:C,trigger:u,onTriggerChange:f,onTriggerEnter:o.useCallback(()=>{c.isOpenDelayedRef.current?O():S()},[c.isOpenDelayedRef,O,S]),onTriggerLeave:o.useCallback(()=>{x?_():(window.clearTimeout(g.current),g.current=0)},[_,x]),onOpen:S,onClose:_,disableHoverableContent:x,children:a})})};xt.displayName=q;var se="TooltipTrigger",gt=o.forwardRef((e,r)=>{const{__scopeTooltip:a,...s}=e,n=$(se,a),i=ve(se,a),l=V(a),d=o.useRef(null),c=ne(r,d,n.onTriggerChange),p=o.useRef(!1),u=o.useRef(!1),f=o.useCallback(()=>p.current=!1,[]);return o.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),t.jsx(or,{asChild:!0,...l,children:t.jsx(T.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...s,ref:c,onPointerMove:R(e.onPointerMove,m=>{m.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),u.current=!0)}),onPointerLeave:R(e.onPointerLeave,()=>{n.onTriggerLeave(),u.current=!1}),onPointerDown:R(e.onPointerDown,()=>{n.open&&n.onClose(),p.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:R(e.onFocus,()=>{p.current||n.onOpen()}),onBlur:R(e.onBlur,n.onClose),onClick:R(e.onClick,n.onClose)})})});gt.displayName=se;var ye="TooltipPortal",[ya,wa]=G(ye,{forceMount:void 0}),bt=e=>{const{__scopeTooltip:r,forceMount:a,children:s,container:n}=e,i=$(ye,r);return t.jsx(ya,{scope:r,forceMount:a,children:t.jsx(le,{present:a||i.open,children:t.jsx(ir,{asChild:!0,container:n,children:s})})})};bt.displayName=ye;var D="TooltipContent",vt=o.forwardRef((e,r)=>{const a=wa(D,e.__scopeTooltip),{forceMount:s=a.forceMount,side:n="top",...i}=e,l=$(D,e.__scopeTooltip);return t.jsx(le,{present:s||l.open,children:l.disableHoverableContent?t.jsx(yt,{side:n,...i,ref:r}):t.jsx(ja,{side:n,...i,ref:r})})}),ja=o.forwardRef((e,r)=>{const a=$(D,e.__scopeTooltip),s=ve(D,e.__scopeTooltip),n=o.useRef(null),i=ne(r,n),[l,d]=o.useState(null),{trigger:c,onClose:p}=a,u=n.current,{onPointerInTransitChange:f}=s,m=o.useCallback(()=>{d(null),f(!1)},[f]),g=o.useCallback((x,h)=>{const y=x.currentTarget,b={x:x.clientX,y:x.clientY},v=_a(b,y.getBoundingClientRect()),C=Ea(b,v),S=Ra(h.getBoundingClientRect()),_=Oa([...C,...S]);d(_),f(!0)},[f]);return o.useEffect(()=>()=>m(),[m]),o.useEffect(()=>{if(c&&u){const x=y=>g(y,u),h=y=>g(y,c);return c.addEventListener("pointerleave",x),u.addEventListener("pointerleave",h),()=>{c.removeEventListener("pointerleave",x),u.removeEventListener("pointerleave",h)}}},[c,u,g,m]),o.useEffect(()=>{if(l){const x=h=>{const y=h.target,b={x:h.clientX,y:h.clientY},v=c?.contains(y)||u?.contains(y),C=!Ta(b,l);v?m():C&&(m(),p())};return document.addEventListener("pointermove",x),()=>document.removeEventListener("pointermove",x)}},[c,u,l,p,m]),t.jsx(yt,{...e,ref:i})}),[Ca,Na]=G(q,{isInside:!1}),Sa=Yt("TooltipContent"),yt=o.forwardRef((e,r)=>{const{__scopeTooltip:a,children:s,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:l,...d}=e,c=$(D,a),p=V(a),{onClose:u}=c;return o.useEffect(()=>(document.addEventListener(ae,u),()=>document.removeEventListener(ae,u)),[u]),o.useEffect(()=>{if(c.trigger){const f=m=>{m.target?.contains(c.trigger)&&u()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[c.trigger,u]),t.jsx(cr,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:l,onFocusOutside:f=>f.preventDefault(),onDismiss:u,children:t.jsxs(dr,{"data-state":c.stateAttribute,...p,...d,ref:r,style:{...d.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[t.jsx(Sa,{children:s}),t.jsx(Ca,{scope:a,isInside:!0,children:t.jsx(ur,{id:c.contentId,role:"tooltip",children:n||s})})]})})});vt.displayName=D;var wt="TooltipArrow",jt=o.forwardRef((e,r)=>{const{__scopeTooltip:a,...s}=e,n=V(a);return Na(wt,a).isInside?null:t.jsx(lr,{...n,...s,ref:r})});jt.displayName=wt;function _a(e,r){const a=Math.abs(r.top-e.y),s=Math.abs(r.bottom-e.y),n=Math.abs(r.right-e.x),i=Math.abs(r.left-e.x);switch(Math.min(a,s,n,i)){case i:return"left";case n:return"right";case a:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function Ea(e,r,a=5){const s=[];switch(r){case"top":s.push({x:e.x-a,y:e.y+a},{x:e.x+a,y:e.y+a});break;case"bottom":s.push({x:e.x-a,y:e.y-a},{x:e.x+a,y:e.y-a});break;case"left":s.push({x:e.x+a,y:e.y-a},{x:e.x+a,y:e.y+a});break;case"right":s.push({x:e.x-a,y:e.y-a},{x:e.x-a,y:e.y+a});break}return s}function Ra(e){const{top:r,right:a,bottom:s,left:n}=e;return[{x:n,y:r},{x:a,y:r},{x:a,y:s},{x:n,y:s}]}function Ta(e,r){const{x:a,y:s}=e;let n=!1;for(let i=0,l=r.length-1;i<r.length;l=i++){const d=r[i],c=r[l],p=d.x,u=d.y,f=c.x,m=c.y;u>s!=m>s&&a<(f-p)*(s-u)/(m-u)+p&&(n=!n)}return n}function Oa(e){const r=e.slice();return r.sort((a,s)=>a.x<s.x?-1:a.x>s.x?1:a.y<s.y?-1:a.y>s.y?1:0),ka(r)}function ka(e){if(e.length<=1)return e.slice();const r=[];for(let s=0;s<e.length;s++){const n=e[s];for(;r.length>=2;){const i=r[r.length-1],l=r[r.length-2];if((i.x-l.x)*(n.y-l.y)>=(i.y-l.y)*(n.x-l.x))r.pop();else break}r.push(n)}r.pop();const a=[];for(let s=e.length-1;s>=0;s--){const n=e[s];for(;a.length>=2;){const i=a[a.length-1],l=a[a.length-2];if((i.x-l.x)*(n.y-l.y)>=(i.y-l.y)*(n.x-l.x))a.pop();else break}a.push(n)}return a.pop(),r.length===1&&a.length===1&&r[0].x===a[0].x&&r[0].y===a[0].y?r:r.concat(a)}var Da=ht,Aa=xt,Ma=gt,Ia=bt,Pa=vt,La=jt;function Ct({delayDuration:e=0,...r}){return t.jsx(Da,{"data-slot":"tooltip-provider",delayDuration:e,...r})}function qa({...e}){return t.jsx(Ct,{children:t.jsx(Aa,{"data-slot":"tooltip",...e})})}function Qa({...e}){return t.jsx(Ma,{"data-slot":"tooltip-trigger",...e})}function za({className:e,sideOffset:r=0,children:a,...s}){return t.jsx(Ia,{children:t.jsxs(Pa,{"data-slot":"tooltip-content",sideOffset:r,className:j("bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...s,children:[a,t.jsx(La,{className:"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}const $a="sidebar_state",Fa=3600*24*7,Ba="16rem",Ua="18rem",Ha="3rem",Ka="b",Nt=o.createContext(null);function A(){const e=o.useContext(Nt);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}function Ga({defaultOpen:e=!0,open:r,onOpenChange:a,className:s,style:n,children:i,...l}){const d=ca(),[c,p]=o.useState(!1),[u,f]=o.useState(e),m=r??u,g=o.useCallback(b=>{const v=typeof b=="function"?b(m):b;a?a(v):f(v),document.cookie=`${$a}=${v}; path=/; max-age=${Fa}`},[a,m]),x=o.useCallback(()=>d?p(b=>!b):g(b=>!b),[d,g,p]);o.useEffect(()=>{const b=v=>{v.key===Ka&&(v.metaKey||v.ctrlKey)&&(v.preventDefault(),x())};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[x]);const h=m?"expanded":"collapsed",y=o.useMemo(()=>({state:h,open:m,setOpen:g,isMobile:d,openMobile:c,setOpenMobile:p,toggleSidebar:x}),[h,m,g,d,c,p,x]);return t.jsx(Nt.Provider,{value:y,children:t.jsx(Ct,{delayDuration:0,children:t.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":Ba,"--sidebar-width-icon":Ha,...n},className:j("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",s),...l,children:i})})})}function Va({side:e="left",variant:r="sidebar",collapsible:a="offcanvas",className:s,children:n,...i}){const{isMobile:l,state:d,openMobile:c,setOpenMobile:p}=A();return a==="none"?t.jsx("div",{"data-slot":"sidebar",className:j("bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",s),...i,children:n}):l?t.jsx(da,{open:c,onOpenChange:p,...i,children:t.jsxs(pa,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden",style:{"--sidebar-width":Ua},side:e,children:[t.jsxs(ma,{className:"sr-only",children:[t.jsx(ha,{children:"Sidebar"}),t.jsx(xa,{children:"Displays the mobile sidebar."})]}),t.jsx("div",{className:"flex h-full w-full flex-col",children:n})]})}):t.jsxs("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":d,"data-collapsible":d==="collapsed"?a:"","data-variant":r,"data-side":e,"data-slot":"sidebar",children:[t.jsx("div",{"data-slot":"sidebar-gap",className:j("relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",r==="floating"||r==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)")}),t.jsx("div",{"data-slot":"sidebar-container",className:j("fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",r==="floating"||r==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l",s),...i,children:t.jsx("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:n})})]})}function Wa({className:e,onClick:r,...a}){const{toggleSidebar:s}=A();return t.jsxs(E,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:j("size-7",e),onClick:n=>{r?.(n),s()},...a,children:[t.jsx(Zr,{}),t.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function Ya({className:e,...r}){const{toggleSidebar:a}=A();return t.jsx("button",{"data-sidebar":"rail","data-slot":"sidebar-rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:a,title:"Toggle Sidebar",className:j("hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex","in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...r})}function Xa({className:e,...r}){return t.jsx("main",{"data-slot":"sidebar-inset",className:j("bg-background relative flex w-full flex-1 flex-col","md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",e),...r})}function Ja({className:e,...r}){return t.jsx("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:j("flex flex-col gap-2 p-2",e),...r})}function Za({className:e,...r}){return t.jsx("div",{"data-slot":"sidebar-footer","data-sidebar":"footer",className:j("flex flex-col gap-2 p-2",e),...r})}function es({className:e,...r}){return t.jsx("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:j("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...r})}function ts({className:e,...r}){return t.jsx("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:j("relative flex w-full min-w-0 flex-col p-2",e),...r})}function rs({className:e,asChild:r=!1,...a}){const s=r?oe:"div";return t.jsx(s,{"data-slot":"sidebar-group-label","data-sidebar":"group-label",className:j("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...a})}function we({className:e,...r}){return t.jsx("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:j("flex w-full min-w-0 flex-col gap-1",e),...r})}function je({className:e,...r}){return t.jsx("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:j("group/menu-item relative",e),...r})}const as=Xt("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function Ce({asChild:e=!1,isActive:r=!1,variant:a="default",size:s="default",tooltip:n,className:i,...l}){const d=e?oe:"button",{isMobile:c,state:p}=A(),u=t.jsx(d,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":s,"data-active":r,className:j(as({variant:a,size:s}),i),...l});return n?(typeof n=="string"&&(n={children:n}),t.jsxs(qa,{children:[t.jsx(Qa,{asChild:!0,children:u}),t.jsx(za,{side:"right",align:"center",hidden:p!=="collapsed"||c,...n})]})):u}function ss({className:e,...r}){return t.jsx("ul",{"data-slot":"sidebar-menu-sub","data-sidebar":"menu-sub",className:j("border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...r})}function ns({className:e,...r}){return t.jsx("li",{"data-slot":"sidebar-menu-sub-item","data-sidebar":"menu-sub-item",className:j("group/menu-sub-item relative",e),...r})}function os({asChild:e=!1,size:r="md",isActive:a=!1,className:s,...n}){const i=e?oe:"a";return t.jsx(i,{"data-slot":"sidebar-menu-sub-button","data-sidebar":"menu-sub-button","data-size":r,"data-active":a,className:j("text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",r==="sm"&&"text-xs",r==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",s),...n})}const is=o.createContext(void 0),ls={setTheme:e=>{},themes:[]},cs=()=>{var e;return(e=o.useContext(is))!==null&&e!==void 0?e:ls},ds=({...e})=>{const{theme:r="system"}=cs();return t.jsx(jr,{theme:r,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function Pe(e,r){const a=new Set(r);return e.filter(s=>!a.has(s))}function us(e,r,a){const s=e.slice(0);return s[r]=a,s}var fs=class extends fr{#a;#e;#s;#n;#t;#r;#o;#i;#l=[];constructor(e,r,a){super(),this.#a=e,this.#n=a,this.#s=[],this.#t=[],this.#e=[],this.setQueries(r)}onSubscribe(){this.listeners.size===1&&this.#t.forEach(e=>{e.subscribe(r=>{this.#f(e,r)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#t.forEach(e=>{e.destroy()})}setQueries(e,r){this.#s=e,this.#n=r,L.batch(()=>{const a=this.#t,s=this.#u(this.#s);this.#l=s,s.forEach(u=>u.observer.setOptions(u.defaultedQueryOptions));const n=s.map(u=>u.observer),i=n.map(u=>u.getCurrentResult()),l=a.length!==n.length,d=n.some((u,f)=>u!==a[f]),c=l||d,p=c?!0:i.some((u,f)=>{const m=this.#e[f];return!m||!pr(u,m)});!c&&!p||(c&&(this.#t=n),this.#e=i,this.hasListeners()&&(c&&(Pe(a,n).forEach(u=>{u.destroy()}),Pe(n,a).forEach(u=>{u.subscribe(f=>{this.#f(u,f)})})),this.#p()))})}getCurrentResult(){return this.#e}getQueries(){return this.#t.map(e=>e.getCurrentQuery())}getObservers(){return this.#t}getOptimisticResult(e,r){const a=this.#u(e),s=a.map(n=>n.observer.getOptimisticResult(n.defaultedQueryOptions));return[s,n=>this.#d(n??s,r),()=>this.#c(s,a)]}#c(e,r){return r.map((a,s)=>{const n=e[s];return a.defaultedQueryOptions.notifyOnChangeProps?n:a.observer.trackResult(n,i=>{r.forEach(l=>{l.observer.trackProp(i)})})})}#d(e,r){return r?((!this.#r||this.#e!==this.#i||r!==this.#o)&&(this.#o=r,this.#i=this.#e,this.#r=Ye(this.#r,r(e))),this.#r):e}#u(e){const r=new Map(this.#t.map(s=>[s.options.queryHash,s])),a=[];return e.forEach(s=>{const n=this.#a.defaultQueryOptions(s),i=r.get(n.queryHash);i?a.push({defaultedQueryOptions:n,observer:i}):a.push({defaultedQueryOptions:n,observer:new Xe(this.#a,n)})}),a}#f(e,r){const a=this.#t.indexOf(e);a!==-1&&(this.#e=us(this.#e,a,r),this.#p())}#p(){if(this.hasListeners()){const e=this.#r,r=this.#c(this.#e,this.#l),a=this.#d(r,this.#n?.combine);e!==a&&L.batch(()=>{this.listeners.forEach(s=>{s(this.#e)})})}}};function ps({queries:e,...r},a){const s=z(a),n=hr(),i=xr(),l=o.useMemo(()=>e.map(h=>{const y=s.defaultQueryOptions(h);return y._optimisticResults=n?"isRestoring":"optimistic",y}),[e,s,n]);l.forEach(h=>{gr(h),br(h,i)}),vr(i);const[d]=o.useState(()=>new fs(s,l,r)),[c,p,u]=d.getOptimisticResult(l,r.combine),f=!n&&r.subscribed!==!1;o.useSyncExternalStore(o.useCallback(h=>f?d.subscribe(L.batchCalls(h)):mr,[d,f]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),o.useEffect(()=>{d.setQueries(l,r)},[l,r,d]);const g=c.some((h,y)=>Re(l[y],h))?c.flatMap((h,y)=>{const b=l[y];if(b){const v=new Xe(s,b);if(Re(b,h))return Te(b,v,i);yr(h,n)&&Te(b,v,i)}return[]}):[];if(g.length>0)throw Promise.all(g);const x=c.find((h,y)=>{const b=l[y];return b&&wr({result:h,errorResetBoundary:i,throwOnError:b.throwOnError,query:s.getQueryCache().get(b.queryHash),suspense:b.suspense})});if(x?.error)throw x.error;return p(u())}function ms(e,r){const a=z(r),s=a.getQueryCache();return o.useSyncExternalStore(o.useCallback(n=>s.subscribe(L.batchCalls(n)),[s]),()=>a.isFetching(e),()=>a.isFetching(e))}function hs(e,r){const a=z(r);return xs({filters:{...e,status:"pending"}},a).length}function Le(e,r){return e.findAll(r.filters).map(a=>r.select?r.select(a):a.state)}function xs(e={},r){const a=z(r).getMutationCache(),s=o.useRef(e),n=o.useRef(null);return n.current===null&&(n.current=Le(a,e)),o.useEffect(()=>{s.current=e}),o.useSyncExternalStore(o.useCallback(i=>a.subscribe(()=>{const l=Ye(n.current,Le(a,s.current));n.current!==l&&(n.current=l,L.schedule(i))}),[a]),()=>n.current,()=>n.current)}function gs({children:e}){const r=Ue(),{user:a,isLoading:s,refreshSession:n}=ce(),i=o.useRef(!1),[l,d]=o.useState(!1);if(o.useEffect(()=>{s||a||i.current||(i.current=!0,d(!0),(async()=>{try{await n().catch(()=>{}),await new Promise(c=>setTimeout(c,50))}finally{d(!1)}})())},[s,a,n]),!a){const c=encodeURIComponent(`${r.pathname}${r.search}`);return t.jsx(Gt,{to:`/login?redirectTo=${c}`,replace:!0})}return t.jsx(t.Fragment,{children:e})}const qe=["comensal","user","admin","superadmin"],Qe={comensal:"Comensal",user:"Fiscal",admin:"Gestor",superadmin:"SDAB"},St={comensal:Er,user:Sr,admin:Nr,superadmin:Cr},_t={comensal:[{title:"Previsão",url:"/rancho"}],user:[{title:"Leitor QrCode",url:"/fiscal"}],admin:[{title:"Painel do rancho",url:"/admin"}],superadmin:[{title:"Painel do sistema",url:"/superadmin"}]};function Et(e){const r=qe.indexOf(e);return r>=0?qe.slice(0,r+1):["comensal"]}function bs({level:e,activePath:r}){const s=Et(e).map(n=>{const i=_t[n]??[],l=!!r&&i.some(d=>d.url===r);return{title:Qe[n],icon:St[n],isActive:l,items:i}});return{teams:[{name:"SISUB",logo:"sheets",plan:Qe[e]}],navMain:s}}function vs(e){return Et(e).flatMap(a=>(_t[a]??[]).map(s=>({to:s.url,label:s.title,icon:St[a]})))}function ys({open:e,onOpenChange:r,userId:a,onCopy:s,hasCopied:n}){const i=o.useId(),l=o.useId(),d=o.useRef(null),c=!!a,p=o.useCallback(()=>{if(!(!d.current||!a))try{const f=d.current.toDataURL("image/png"),m=document.createElement("a");m.href=f,m.download=`user-${a}-qrcode.png`,m.click()}catch{}},[a]),u=o.useCallback(f=>{(f.ctrlKey||f.metaKey)&&f.key.toLowerCase()==="c"&&c&&(f.preventDefault(),s())},[s,c]);return t.jsx(de,{open:e,onOpenChange:r,children:t.jsxs(ue,{"aria-labelledby":i,"aria-describedby":l,onKeyDown:u,className:"w-[95vw] max-w-md overflow-hidden p-0",children:[t.jsx("div",{className:"bg-primary px-4 py-3 text-primary-foreground sm:px-6 sm:py-4",children:t.jsxs(fe,{children:[t.jsxs(pe,{id:i,className:"flex items-center gap-2 text-lg font-bold sm:text-xl",children:[t.jsx("span",{"aria-hidden":"true",className:"inline-flex rounded-lg bg-primary-foreground/15 p-1.5 sm:p-2",children:t.jsx(Ze,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),t.jsx("span",{children:"Seu QR Code"})]}),t.jsx(me,{id:l,className:"mt-1 text-sm text-primary-foreground/80 sm:mt-2",children:"Use este código para identificação rápida no sistema."}),t.jsxs(He,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute right-4 top-4 rounded-xs opacity-90 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[t.jsx(Ke,{"aria-hidden":"true",className:"stroke-background"}),t.jsx("span",{className:"sr-only",children:"Fechar"})]})]})}),t.jsx("div",{className:"bg-muted px-3 py-4 sm:px-6 sm:py-8",children:t.jsxs("div",{className:"flex flex-col items-center gap-4 sm:gap-5",children:[t.jsx("div",{className:"rounded-xl border-2 bg-white shadow-lg sm:rounded-2xl sm:border-4 p-2",children:c?t.jsx(Rr,{role:"img","aria-label":`QR Code para o usuário ${a}`,value:a??"",size:240,level:"M",includeMargin:!0,bgColor:"#ffffff",fgColor:"#111827",ref:d,className:"w-full h-full rounded-2xl"}):t.jsx("div",{"aria-busy":"true",className:"h-[140px] w-[140px] animate-pulse rounded-md bg-muted-foreground/10 sm:h-[180px] sm:w-[180px]"})}),t.jsxs("div",{className:"w-full max-w-xs space-y-2 text-center sm:max-w-sm",children:[t.jsx("p",{className:"text-xs font-medium text-muted-foreground sm:text-sm",children:"ID do Usuário"}),t.jsx("div",{className:"w-full overflow-hidden rounded-lg border bg-card px-2 py-1.5 font-mono text-xs text-foreground sm:px-4 sm:py-2",children:t.jsx("span",{className:"block truncate text-center",children:a??"N/A"})}),t.jsxs("div",{className:"flex w-full flex-col items-center gap-2 sm:flex-row sm:justify-center",children:[t.jsxs(E,{type:"button",variant:"secondary",size:"sm",onClick:s,disabled:!c,className:"w-full sm:w-auto",children:[t.jsx(Tr,{className:"mr-2 h-3.5 w-3.5","aria-hidden":"true"}),n?"Copiado!":"Copiar ID"]}),t.jsxs(E,{type:"button",variant:"default",size:"sm",onClick:p,disabled:!c,className:"w-full sm:w-auto",children:[t.jsx(Or,{className:"mr-2 h-3.5 w-3.5","aria-hidden":"true"}),"Baixar PNG"]})]}),t.jsx("p",{className:"mt-1 text-[11px] text-muted-foreground sm:text-xs",children:"Não compartilhe seu QR Code publicamente."})]})]})})]})})}const ws=[1,2,3,4,5],js={1:"Péssimo",2:"Ruim",3:"Ok",4:"Bom",5:"Excelente"};function Cs(e,r){const a=r===e,s="flex h-12 w-12 items-center justify-center rounded-lg font-semibold transition-transform select-none border peer-focus-visible:ring-2 peer-focus-visible:ring-ring peer-focus-visible:ring-offset-2";return a?e<=2?j(s,"bg-destructive text-destructive-foreground shadow-md scale-105"):e===3?j(s,"bg-secondary text-secondary-foreground shadow-md scale-105"):j(s,"bg-primary text-primary-foreground shadow-md scale-105"):j(s,"bg-muted text-muted-foreground hover:scale-105")}function Ns(e){if(e!=null)return e<=2?"bg-destructive text-destructive-foreground hover:opacity-90":e===3?"bg-secondary text-secondary-foreground hover:opacity-90":"bg-primary text-primary-foreground hover:opacity-90"}function Ss({open:e,question:r,selectedRating:a,isSubmitting:s,onOpenChange:n,onSelectRating:i,onSubmit:l}){const d=r||"Como você avalia?",c=p=>{p.preventDefault(),a!=null&&!s&&l()};return t.jsx(de,{open:e,onOpenChange:n,children:t.jsxs(ue,{className:"sm:max-w-md",showCloseButton:!0,"aria-busy":s,children:[t.jsxs(fe,{children:[t.jsx(pe,{children:"Avaliação rápida"}),t.jsx(me,{className:"py-4 text-center text-2xl text-foreground",children:d})]}),t.jsxs("form",{onSubmit:c,children:[t.jsx("p",{className:"mb-3 text-center text-sm text-muted-foreground",children:"Sua opinião ajuda a melhorar a experiência. Escolha uma nota de 1 a 5:"}),t.jsxs("fieldset",{className:"relative mx-auto w-full max-w-xs","aria-label":"Avaliação de 1 a 5",children:[t.jsx("legend",{className:"sr-only",children:"Selecione uma nota"}),t.jsx("div",{className:"relative flex items-center justify-between gap-2 p-2",children:ws.map(p=>t.jsxs("label",{className:"relative",children:[t.jsx("input",{type:"radio",name:"rating",value:p,className:"peer sr-only",checked:a===p,onChange:()=>i(p),"aria-label":`Nota ${p} de 5: ${js[p]}`}),t.jsx("span",{className:Cs(p,a),children:p})]},p))}),t.jsxs("div",{className:"mt-2 flex justify-between px-2 text-[11px] text-muted-foreground",children:[t.jsx("span",{children:"Péssimo"}),t.jsx("span",{children:"Excelente"})]})]}),t.jsx(Je,{className:"mt-6",children:t.jsx(E,{type:"submit",disabled:a==null||s,className:Ns(a),children:s?t.jsxs("span",{className:"inline-flex items-center gap-2",children:[t.jsx("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-b-transparent",role:"status","aria-label":"Enviando"}),"Enviando..."]}):"Enviar"})})]})]})})}const ze=7;function _s({open:e,nrOrdem:r,error:a,isSaving:s,onOpenChange:n,onChange:i,onSubmit:l}){const d=o.useId(),c=o.useId(),p=r.trim().length>0&&!s,u=o.useCallback(x=>x.replace(/\D/g,"").slice(0,ze),[]),f=o.useCallback(x=>{i(u(x.target.value))},[i,u]),m=o.useCallback(x=>{x.preventDefault();const h=x.clipboardData.getData("text");i(u(h))},[i,u]),g=o.useCallback(x=>{x.preventDefault(),p&&l()},[p,l]);return t.jsx(de,{open:e,onOpenChange:n,children:t.jsxs(ue,{className:"sm:max-w-md",showCloseButton:!1,"aria-busy":s,onInteractOutside:x=>x.preventDefault(),onEscapeKeyDown:x=>x.preventDefault(),children:[t.jsxs(fe,{children:[t.jsx(pe,{children:"Informe seu SARAM"}),t.jsx(me,{id:d,children:"Para continuar, precisamos do seu número de registro SARAM (nrOrdem)."})]}),t.jsxs("form",{onSubmit:g,className:"space-y-3",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",htmlFor:"nrOrdemInput",children:"nrOrdem"}),t.jsx(kr,{id:"nrOrdemInput",name:"nrOrdem",value:r,inputMode:"numeric",pattern:"\\d*",enterKeyHint:"done",autoComplete:"one-time-code",placeholder:"Ex.: 1234567",maxLength:ze,onChange:f,onPaste:m,autoFocus:!0,required:!0,"aria-invalid":!!a,"aria-describedby":a?`${d} ${c}`:d}),a&&t.jsx("p",{id:c,role:"alert","aria-live":"polite",className:"text-sm text-destructive",children:a}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Usaremos esse dado apenas para identificar seu registro."})]}),t.jsx(Je,{children:t.jsx(E,{type:"submit",disabled:!p,className:"disabled:cursor-not-allowed disabled:opacity-50",children:s?t.jsxs("span",{className:"inline-flex items-center gap-2",children:[t.jsx("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-b-transparent",role:"status","aria-label":"Salvando"}),"Salvando..."]}):"Salvar e continuar"})})]})]})})}function Es({onOpenQr:e,userId:r}){return t.jsx("header",{className:"sticky top-0 z-40 flex h-14 items-center border-b bg-background/80 px-3 backdrop-blur supports-[backdrop-filter]:bg-background/60 sm:px-4 shrink-0 gap-2 transition-[width,height] ease-linear group-has-data-[collapsible=icon]/sidebar-wrapper:h-12",children:t.jsxs("div",{className:"flex w-full items-center",children:[t.jsx("div",{className:"flex items-center",children:t.jsx(Wa,{})}),t.jsxs("div",{role:"toolbar","aria-label":"Ações rápidas",className:"ml-auto flex items-center gap-2 sm:gap-3",children:[t.jsxs(E,{variant:"outline",size:"sm",onClick:e,className:"flex items-center gap-2 transition-colors hover:border-primary/30 hover:bg-primary/10 hover:text-primary","aria-label":"Abrir QR do usuário",disabled:!r,title:r?"Mostrar QR":"Usuário não identificado",children:[t.jsx(Ze,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden font-medium sm:inline",children:"QR"})]}),t.jsx(Ar,{})]})]})})}function Rs({showInitialError:e,showInitialLoading:r,onRetry:a,children:s}){return t.jsx("div",{className:j(" relative isolate flex flex-col bg-background text-foreground ","min-h-[100svh] supports-[height:100dvh]:min-h-[100dvh]","before:content-[''] before:absolute before:inset-0 before:-z-10 before:pointer-events-none","before:bg-[radial-gradient(1200px_800px_at_10%_-10%,rgb(52_211_153/0.14),transparent_60%),radial-gradient(900px_600px_at_90%_0%,rgb(6_182_212/0.12),transparent_60%),radial-gradient(800px_800px_at_50%_100%,rgb(139_92_246/0.10),transparent_60%)]","dark:before:bg-[radial-gradient(1200px_800px_at_10%_-10%,rgb(110_231_183/0.18),transparent_60%),radial-gradient(900px_600px_at_90%_0%,rgb(34_211_238/0.16),transparent_60%),radial-gradient(800px_800px_at_50%_100%,rgb(167_139_250/0.14),transparent_60%)]","before:transform-gpu motion-safe:before:animate-[slow-pan_32s_ease-in-out_infinite]","after:content-[''] after:pointer-events-none after:absolute after:inset-0 after:-z-10","after:bg-[radial-gradient(circle_at_1px_1px,rgba(0,0,0,0.8)_1px,transparent_1px)]","after:bg-[length:12px_12px] after:opacity-[0.02]","dark:after:opacity-[0.04]"),children:e?t.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-3 p-6 text-center",children:[t.jsx("p",{className:"text-sm font-medium text-destructive",children:"Não foi possível carregar suas permissões no momento."}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Atualize a página ou entre em contato com um administrador."}),t.jsx(E,{size:"sm",variant:"outline",onClick:a,children:"Tentar novamente"})]}):r?t.jsx("div",{className:"flex h-full items-center justify-center p-6 text-sm text-muted-foreground",children:"Carregando painel..."}):s})}function Ts({items:e}){return t.jsxs(ts,{children:[t.jsx(rs,{children:"Previsão"}),t.jsx(we,{children:e.map(r=>t.jsx(oa,{asChild:!0,defaultOpen:r.isActive,className:"group/collapsible",children:t.jsxs(je,{children:[t.jsx(ia,{asChild:!0,children:t.jsxs(Ce,{tooltip:r.title,children:[r.icon&&t.jsx(r.icon,{}),t.jsx("span",{children:r.title}),t.jsx(_r,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),t.jsx(la,{children:t.jsx(ss,{children:r.items?.map(a=>t.jsx(ns,{children:t.jsx(os,{asChild:!0,children:t.jsx("a",{href:a.url,children:t.jsx("span",{children:a.title})})})},a.title))})})]})},r.title))})]})}function $e(e){const a=e.split("@")[0].trim().split(/\s+/);return a.length===1?a[0].slice(0,2).toUpperCase():(a[0][0]+a[a.length-1][0]).toUpperCase()}function Os(){const{isMobile:e}=A(),{user:r,isAuthenticated:a,isLoading:s,signOut:n}=ce(),i=r?.user_metadata??{},l=r?.email??"",d=i.name||i.full_name||l||"Usuário",c=i.avatar_url||i.picture||"";return t.jsx(we,{children:t.jsx(je,{children:s?t.jsx("div",{className:"h-8 w-full rounded-lg bg-muted animate-pulse","aria-hidden":"true"}):a?t.jsxs(et,{children:[t.jsx(tt,{asChild:!0,children:t.jsxs(Ce,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground px-2",children:[t.jsxs(Ae,{className:"h-8 w-8 rounded-lg grayscale",children:[t.jsx(Me,{src:c,alt:d}),t.jsx(Ie,{className:"rounded-lg",children:$e(d)})]}),t.jsxs("div",{className:"hidden sm:grid flex-1 text-left text-sm leading-tight ml-2",children:[t.jsx("span",{className:"truncate font-medium",children:d}),t.jsx("span",{className:"text-muted-foreground truncate text-xs",children:l})]}),t.jsx(Wr,{className:"ml-2 h-4 w-4","aria-hidden":"true"})]})}),t.jsxs(rt,{className:"w-(--radix-dropdown-menu-trigger-width) min-w-56 rounded-lg",side:e?"bottom":"right",align:"end",sideOffset:6,children:[t.jsx(at,{className:"p-0 font-normal",children:t.jsxs("div",{className:"flex items-center gap-2 px-2 py-2 text-left text-sm",children:[t.jsxs(Ae,{className:"h-8 w-8 rounded-lg",children:[t.jsx(Me,{src:c,alt:d}),t.jsx(Ie,{className:"rounded-lg",children:$e(d)})]}),t.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[t.jsx("span",{className:"truncate font-medium",children:d}),t.jsx("span",{className:"text-muted-foreground truncate text-xs",children:l})]})]})}),t.jsx(Mr,{}),t.jsxs(re,{onSelect:()=>{window.location.assign("/profile")},className:"cursor-pointer",children:[t.jsx(ta,{className:"mr-2 h-4 w-4"}),"Perfil"]}),t.jsxs(re,{onSelect:async()=>{await n(),window.location.assign("/login")},className:"text-red-600 focus:text-red-600 cursor-pointer",children:[t.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Sair"]})]})]}):t.jsx(E,{variant:"outline",size:"sm",onClick:()=>window.location.assign("/login"),children:"Entrar"})})})}function ks({teams:e}){const{isMobile:r}=A(),[a,s]=o.useState(e[0]);return a?t.jsx(we,{children:t.jsx(je,{children:t.jsxs(et,{children:[t.jsx(tt,{asChild:!0,children:t.jsxs(Ce,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[t.jsx("div",{className:"bg-sidebar-primary text-sidebar-primary-foreground flex aspect-square size-8 items-center justify-center rounded-lg",children:t.jsx("img",{src:"/favicon.svg",className:"shrink-0 rounded-full"})}),t.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[t.jsx("span",{className:"truncate font-medium",children:a.name}),t.jsx("span",{className:"truncate text-xs",children:a.plan})]}),t.jsx(Gr,{className:"ml-auto"})]})}),t.jsxs(rt,{className:"w-(--radix-dropdown-menu-trigger-width) min-w-56 ",align:"start",side:r?"bottom":"right",sideOffset:4,children:[t.jsx(at,{className:"text-muted-foreground text-xs",children:"Sistemas"}),e.map((n,i)=>t.jsxs(re,{onClick:()=>s(n),className:"gap-2 p-2",children:[t.jsx("div",{className:"flex size-6 items-center justify-center rounded-md border",children:t.jsx("img",{src:"/favicon.svg",className:"shrink-0 rounded-full"})}),n.name]},n.name))]})]})})}):null}function Ds({data:e,...r}){return t.jsxs(Va,{collapsible:"icon",variant:"floating",...r,children:[t.jsx(Ja,{children:t.jsx(ks,{teams:e.teams})}),t.jsx(es,{children:t.jsx(Ts,{items:e.navMain})}),t.jsx(Za,{children:t.jsx(Os,{})}),t.jsx(Ya,{})]})}const As=7;function Ms(){const e=Ue(),r=z(),{user:a}=ce(),s=a?.id??null,{data:n,isLoading:i,isError:l}=Dr(a?.id),d=o.useMemo(()=>{if(!a)return{name:"Usuário",email:"",avatar:""};const w=a.user_metadata?.full_name??a.user_metadata?.name??a.email??"Usuário",N=a.user_metadata?.avatar_url??"";return{name:w,email:a.email??"",avatar:N}},[a]),c=o.useMemo(()=>!n||!a?null:bs({level:n,activePath:e.pathname}),[e.pathname,a,n,d]),p=o.useMemo(()=>n?vs(n):[],[n]),u=!!c&&!l,[f,m]=ps({queries:[{queryKey:P.userNrOrdem(s),queryFn:()=>Ls(s),enabled:!!s,staleTime:Fe,gcTime:Be},{queryKey:P.evaluation(s),queryFn:()=>qs(s),enabled:!!s,staleTime:Fe,gcTime:Be}]}),g=J({mutationFn:Is,onError:w=>console.error("Erro ao sincronizar email:",w)});o.useEffect(()=>{a&&g.mutate(a)},[a?.id]);const[x,h]=o.useState(!1),[y,b]=o.useState(""),[v,C]=o.useState(null),S=!!s&&f.isSuccess&&!f.data,_=S||x;o.useEffect(()=>{if(!s){h(!1),b("");return}const w=f.data;b(w?String(w):"")},[s,f.data]);const O=J({mutationFn:w=>Ps(a,w),onMutate:async w=>{if(!s)return;C(null);const N=P.userNrOrdem(s);await r.cancelQueries({queryKey:N});const I=r.getQueryData(N);return r.setQueryData(N,w),{previous:I,queryKey:N}},onError:(w,N,I)=>{console.error("Erro ao salvar nrOrdem:",w),I?.previous&&r.setQueryData(I.queryKey,I.previous),C("Não foi possível salvar. Tente novamente.")},onSuccess:()=>h(!1),onSettled:()=>{s&&r.invalidateQueries({queryKey:P.userNrOrdem(s)})}}),F=o.useCallback(w=>{!w&&S||h(w)},[S]),Rt=o.useCallback(w=>{b(w),v&&C(null)},[v]),Tt=o.useCallback(()=>{const w=y.replace(/\D/g,"").trim();if(!w){C("Informe seu número da Ordem.");return}if(w.length<As){C("Nr. da Ordem parece curto. Confira e tente novamente.");return}a&&O.mutate(w)},[y,O,a]),[Ot,W]=o.useState(!1),[B,Y]=o.useState(null);o.useEffect(()=>{W(!1),Y(null)},[m.data?.question]);const U=m.data?.question??null,kt=!!(m.data?.shouldAsk&&U),Dt=!!s&&m.isSuccess&&kt&&!_&&!Ot,Ne=o.useCallback(w=>{w?W(!1):(W(!0),Y(null))},[]),X=J({mutationFn:async w=>{const{error:N}=await k.from("opinions").insert([{value:w.value,question:w.question,userId:a.id}]);if(N)throw N},onError:w=>console.error("Erro ao registrar voto:",w),onSuccess:()=>Ne(!1),onSettled:()=>{s&&r.invalidateQueries({queryKey:P.evaluation(s)})}}),At=o.useCallback(()=>{const w=U;!s||!w||B==null||X.mutate({value:B,question:w})},[U,B,X,s]),[Mt,Se]=o.useState(!1),[It,_e]=o.useState(!1),[Pt,Ee]=o.useState(!1),M=o.useRef(null),Lt=o.useCallback(async()=>{if(a?.id&&!(typeof navigator>"u"||!navigator.clipboard))try{await navigator.clipboard.writeText(a.id),Ee(!0),M.current&&clearTimeout(M.current),M.current=setTimeout(()=>Ee(!1),1600)}catch(w){console.error("Erro ao copiar ID:",w)}},[a]);o.useEffect(()=>()=>{M.current&&clearTimeout(M.current)},[]);const qt=ms(),Qt=hs(),zt=qt+Qt>0||i||f.isFetching||m.isFetching,$t=O.isPending,Ft=X.isPending,Bt=i&&!n,Ut=!i&&l,Ht=o.useCallback(()=>{typeof window<"u"&&window.location.reload()},[]);return t.jsxs(t.Fragment,{children:[t.jsx(_s,{open:_,nrOrdem:y,error:v,isSaving:$t,onOpenChange:F,onChange:Rt,onSubmit:Tt}),t.jsx(Ss,{open:Dt,question:U,selectedRating:B,isSubmitting:Ft,onOpenChange:Ne,onSelectRating:Y,onSubmit:At}),t.jsx(ys,{open:It,onOpenChange:_e,userId:s,onCopy:Lt,hasCopied:Pt}),u&&c?t.jsx(Ds,{data:c}):null,t.jsx(Xa,{children:t.jsxs("div",{className:"flex min-h-[100svh] w-full flex-col supports-[height:100dvh]:min-h-[100dvh]",children:[t.jsx(Es,{showSidebar:u,navItems:p,sheetOpen:Mt,onSheetOpenChange:Se,onSidebarNavigate:()=>Se(!1),showGlobalProgress:zt,onOpenQr:()=>_e(!0),userId:s}),t.jsx("main",{id:"conteudo",className:"flex-1",children:t.jsx(Rs,{showInitialError:Ut,showInitialLoading:Bt,onRetry:Ht,children:t.jsx(Vt,{})})})]})}),t.jsx(ds,{position:"bottom-center",richColors:!0,expand:!0,className:"z-[2147483647]"})]})}const Fe=5*6e4,Be=10*6e4,P={userNrOrdem:e=>["user",e,"nrOrdem"],evaluation:e=>["evaluation",e]};async function Is(e){const{error:r}=await k.from("user_data").upsert({id:e.id,email:e.email},{onConflict:"id"});if(r)throw r}async function Ps(e,r){const{error:a}=await k.from("user_data").upsert({id:e.id,email:e.email,nrOrdem:r},{onConflict:"id"});if(a)throw a}async function Ls(e){const{data:r,error:a}=await k.from("user_data").select("nrOrdem").eq("id",e).maybeSingle();if(a)throw a;const s=r?.nrOrdem,n=s!=null?String(s):null;return n&&n.trim().length>0?n:null}async function qs(e){const{data:r,error:a}=await k.from("super_admin_controller").select("key, active, value").eq("key","evaluation").maybeSingle();if(a)throw a;const s=!!r?.active,n=r?.value??"";if(!s||!n)return{shouldAsk:!1,question:n||null};const{data:i,error:l}=await k.from("opinions").select("id").eq("question",n).eq("userId",e).maybeSingle();if(l)throw l;return{shouldAsk:!!!i,question:n}}const wn=Wt(function(){return t.jsx(gs,{children:t.jsx(Ga,{children:t.jsx(Ms,{})})})});export{wn as default};
