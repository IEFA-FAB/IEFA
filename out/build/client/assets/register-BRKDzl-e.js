import{a as i,v as J,q as Z,x as A,w as K}from"./chunk-OIYGIGL5-BjQr_l_M.js";import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{F as Q,M as W}from"./mail-C6USHQwt.js";import{u as Y}from"./auth-provider-Diczkjh1.js";import{s as ee,g as se}from"./redirect-D7e2wz-9.js";import{A as ae,a as re,E as R,b as q}from"./eye-DMWkklOV.js";import{B as x}from"./button-Lf--0ePE.js";import{C as v,a as I,b as M,c as O,d as B,e as D}from"./card-CfdgI_6O.js";import{I as b}from"./input-B6_poRDs.js";import{C as f,L as C}from"./label-DlsFJCEv.js";import{c as l}from"./utils-BEHD0UYf.js";import{L as z,C as te}from"./loader-circle-BLBYjE2T.js";import{C as m}from"./check-P3aSJU2R.js";import{L as T}from"./lock-Cn8RQiRM.js";import{X as w}from"./x-GpSf1MKW.js";import"./createLucideIcon-CwMMISn7.js";import"./index-yifceNX_.js";import"./index-B2a0W2do.js";import"./index-CpAFY4EY.js";function oe(s){let o=0;const n={length:s.length>=8,lowercase:/[a-z]/.test(s),uppercase:/[A-Z]/.test(s),numbers:/\d/.test(s),special:/[!@#$%^&*(),.?":{}|<>]/.test(s)};return o=Object.values(n).filter(Boolean).length,{score:o,checks:n,strength:o<2?"weak":o<4?"medium":"strong"}}function ie(s,o){const h=new URLSearchParams(o).toString();return`${s}${h?`?${h}`:""}`}function ce(){const[s,o]=i.useState({email:"",password:"",confirmPassword:""}),[n,h]=i.useState(!1),[g,$]=i.useState(!1),[c,y]=i.useState(!1),[H,P]=i.useState(!1),[k,u]=i.useState(""),[t,U]=i.useState({email:"",password:"",confirmPassword:""}),{signUp:V,isAuthenticated:S,isLoading:j}=Y(),E=J(),d=Z();i.useEffect(()=>{if(!j&&S){const a=ee(se(d.search,d.state),"/rancho");E(a,{replace:!0})}},[S,j,E,d.search,d.state]),i.useEffect(()=>{const a={...t};s.email&&!Q.test(s.email)?a.email="Por favor, utilize um email institucional (@fab.mil.br).":a.email="",s.password&&s.password.length<6?a.password="A senha deve ter pelo menos 6 caracteres.":a.password="",s.confirmPassword&&s.password!==s.confirmPassword?a.confirmPassword="As senhas não coincidem.":a.confirmPassword="",U(a)},[s.email,s.password,s.confirmPassword]);const N=(a,p)=>{o(G=>({...G,[a]:p})),u("")},r=oe(s.password),X=Object.values(t).some(a=>a!==""),F=Object.values(s).every(a=>a.trim()!=="")&&!X,_=async a=>{if(a.preventDefault(),!F){u("Por favor, corrija os erros no formulário.");return}y(!0),u("");try{await V(s.email,s.password),P(!0)}catch(p){console.error("Falha no registro:",p),u(p?.message||"Ocorreu um erro ao criar a conta. Tente novamente.")}finally{y(!1)}},L=ie("/login",d.search);return j?e.jsx(v,{className:"w-full max-w-md mx-auto",children:e.jsxs(I,{className:"flex items-center justify-center py-8",children:[e.jsx(z,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Verificando autenticação..."})]})}):H?e.jsxs(v,{className:"w-full max-w-md mx-auto",children:[e.jsxs(M,{children:[e.jsxs(O,{className:"text-2xl text-center flex items-center justify-center",children:[e.jsx(te,{className:"mr-2 h-8 w-8 text-green-500"}),"Conta Criada!"]}),e.jsxs(B,{className:"text-center pt-4 space-y-2",children:[e.jsxs("p",{children:["Enviamos um link de confirmação para"," ",e.jsx("strong",{children:s.email})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Por favor, verifique sua caixa de entrada (e a pasta de spam) para ativar sua conta."})]})]}),e.jsxs(D,{className:"flex flex-col space-y-3",children:[e.jsx(A,{to:L,className:"w-full",children:e.jsx(x,{className:"w-full",children:"Ir para Login"})}),e.jsx(x,{variant:"outline",className:"w-full",onClick:()=>{P(!1),o({email:"",password:"",confirmPassword:""})},children:"Criar Outra Conta"})]})]}):e.jsxs(v,{className:"w-full max-w-md mx-auto",children:[e.jsxs(M,{className:"space-y-1",children:[e.jsx(O,{className:"text-2xl text-center",children:"Criar Conta"}),e.jsx(B,{className:"text-center",children:"Acesso restrito a emails @fab.mil.br"})]}),e.jsxs("form",{onSubmit:_,children:[e.jsxs(I,{className:"space-y-4",children:[k&&e.jsxs(ae,{variant:"destructive",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx(re,{children:k})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"email",children:"Email Institucional"}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(b,{id:"email",type:"email",placeholder:"seu.nome@fab.mil.br",value:s.email,onChange:a=>N("email",a.target.value.toLowerCase()),className:l("pl-10",{"border-red-500 focus-visible:ring-red-500":t.email,"border-green-500 focus-visible:ring-green-500":s.email&&!t.email}),required:!0,disabled:c,autoComplete:"email"}),s.email&&!t.email&&e.jsx(m,{className:"absolute right-3 top-3 h-4 w-4 text-green-500"})]}),t.email&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 flex items-center",children:[e.jsx(f,{className:"h-3 w-3 mr-1"}),t.email]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"password",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(b,{id:"password",type:n?"text":"password",placeholder:"••••••••",value:s.password,onChange:a=>N("password",a.target.value),className:l("pl-10 pr-10",{"border-red-500 focus-visible:ring-red-500":t.password}),required:!0,disabled:c,autoComplete:"new-password",minLength:6}),e.jsx(x,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>h(!n),disabled:c,children:n?e.jsx(R,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(q,{className:"h-4 w-4 text-muted-foreground"})})]}),s.password&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:l("text-xs font-medium",{"text-red-500":r.strength==="weak","text-yellow-500":r.strength==="medium","text-green-500":r.strength==="strong"}),children:[r.strength==="weak"&&"Fraca",r.strength==="medium"&&"Média",r.strength==="strong"&&"Forte"]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs",children:[e.jsxs("div",{className:l("flex items-center",{"text-green-600":r.checks.length,"text-gray-400":!r.checks.length}),children:[r.checks.length?e.jsx(m,{className:"h-3 w-3 mr-1"}):e.jsx(w,{className:"h-3 w-3 mr-1"}),"8+ caracteres"]}),e.jsxs("div",{className:l("flex items-center",{"text-green-600":r.checks.uppercase,"text-gray-400":!r.checks.uppercase}),children:[r.checks.uppercase?e.jsx(m,{className:"h-3 w-3 mr-1"}):e.jsx(w,{className:"h-3 w-3 mr-1"}),"Maiúscula"]}),e.jsxs("div",{className:l("flex items-center",{"text-green-600":r.checks.lowercase,"text-gray-400":!r.checks.lowercase}),children:[r.checks.lowercase?e.jsx(m,{className:"h-3 w-3 mr-1"}):e.jsx(w,{className:"h-3 w-3 mr-1"}),"Minúscula"]}),e.jsxs("div",{className:l("flex items-center",{"text-green-600":r.checks.numbers,"text-gray-400":!r.checks.numbers}),children:[r.checks.numbers?e.jsx(m,{className:"h-3 w-3 mr-1"}):e.jsx(w,{className:"h-3 w-3 mr-1"}),"Número"]})]})]}),t.password&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 flex items-center",children:[e.jsx(f,{className:"h-3 w-3 mr-1"}),t.password]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"confirmPassword",children:"Confirmar Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(b,{id:"confirmPassword",type:g?"text":"password",placeholder:"••••••••",value:s.confirmPassword,onChange:a=>N("confirmPassword",a.target.value),className:l("pl-10 pr-10",{"border-red-500 focus-visible:ring-red-500":t.confirmPassword,"border-green-500 focus-visible:ring-green-500":s.confirmPassword&&!t.confirmPassword&&s.password===s.confirmPassword}),required:!0,disabled:c,autoComplete:"new-password"}),e.jsx(x,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>$(!g),disabled:c,children:g?e.jsx(R,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(q,{className:"h-4 w-4 text-muted-foreground"})}),s.confirmPassword&&!t.confirmPassword&&s.password===s.confirmPassword&&e.jsx(m,{className:"absolute right-10 top-3 h-4 w-4 text-green-500"})]}),t.confirmPassword&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 flex items-center",children:[e.jsx(f,{className:"h-3 w-3 mr-1"}),t.confirmPassword]})]})]}),e.jsxs(D,{className:"flex flex-col space-y-4",children:[e.jsxs(x,{type:"submit",className:"w-full my-6 py-3 text-lg font-semibold",disabled:!F||c,children:[c&&e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}),c?"Criando conta...":"Criar Conta"]}),e.jsxs("p",{className:"text-sm text-center text-muted-foreground",children:["Já tem uma conta?"," ",e.jsx(A,{to:L,className:"text-primary hover:underline font-medium",children:"Faça login"})]})]})]})]})}function Se({}){return[{title:"Registre-se"},{name:"description",content:"Faça seu Registro"}]}const Ee=K(ce);export{Ee as default,Se as meta};
